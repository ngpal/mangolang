@section data

msg = "hello, world!\n"

@section text

main: 
	DATA      msg
	PUSH16    0
	POPR      r1         ; store the index in r1

loop:
	; duplicate the address

	LOADR     [SP, -2]   
	PUSHR     r1
	LOADP

	; duplicate the character
	LOADR     [SP, -2]   
	PUSH16    0
	CMP
	JEQ       end

	; prints the character at r0
	PUSHR     r0
	CALL      print      

	PUSHR     r1
	PUSH16    1
	POPR      r1
	JMP       loop

end:
	HALT
